<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <!-- Primary Meta Tags -->
  <!-- TODO: Replace with your paper title and author names -->
  <meta name="title" content="From Demonstrations to Safe Deployment: Path-Consistent SafetyFiltering for Diffusion Policies - Römer, Ralf; Balletshofer, Julian; Thumm, Jakob; Pavone, Marco; Schoellig, Angela P.; Althoff, Matthias">
  <!-- TODO: Write a compelling 150-160 character description of your research -->
  <meta name="description" content="This paper presents a novel approach to safe deployment of diffusion policies without compromising task success.">
  <!-- TODO: Add 5-10 relevant keywords for your research area -->
  <meta name="keywords" content="robotics, imitation learning, diffusion policies, safety, human-robot-interaction">
  <!-- TODO: List all authors -->
  <meta name="author" content="Römer, Ralf; Balletshofer, Julian; Thumm, Jakob; Pavone, Marco; Schoellig, Angela P.; Althoff, Matthias">
  <meta name="robots" content="index, follow">
  <meta name="language" content="English">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="article">
  <!-- TODO: Replace with your institution or lab name -->
  <meta property="og:site_name" content="Learning Systems and Robotics Lab (LSY) and Cyber-Physical Systems Group (CPS), TUM">
  <!-- TODO: Same as paper title above -->
  <meta property="og:title" content="From Demonstrations to Safe Deployment: Path-Consistent SafetyFiltering for Diffusion Policies">
  <!-- TODO: Same as description above -->
  <meta property="og:description" content="This paper presents a novel approach to safe deployment of diffusion policies without compromising task success.">
  <!-- TODO: Replace with your actual website URL -->
  <meta property="og:url" content="https://tum-lsy.github.io/pacs/">
  <!-- TODO: Create a 1200x630px preview image and update path -->
  <meta property="og:image" content="https://tum-lsy.github.io/pacs/static/images/social_preview.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="From Demonstrations to Safe Deployment: Path-Consistent SafetyFiltering for Diffusion Policies">
  <meta property="article:published_time" content="2025-10-10T00:00:00.000Z">
  <meta property="article:author" content="Römer, Ralf; Balletshofer, Julian; Thumm, Jakob; Pavone, Marco; Schoellig, Angela P.; Althoff, Matthias">
  <meta property="article:section" content="Research">
  <meta property="article:tag" content="robotics">
  <meta property="article:tag" content="imitation learning">
  <meta property="article:tag" content="diffusion policies">
  <meta property="article:tag" content="safety">
  <meta property="article:tag" content="human-robot-interaction">

  <!-- Academic/Research Specific -->
  <meta name="citation_title" content="From Demonstrations to Safe Deployment: Path-Consistent SafetyFiltering for Diffusion Policies">
  <meta name="citation_author" content="Römer, Ralf">
  <meta name="citation_author" content="Balletshofer, Julian">
  <meta name="citation_author" content="Thumm, Jakob">
  <meta name="citation_author" content="Pavone, Marco">
  <meta name="citation_author" content="Schoellig, Angela P.">
  <meta name="citation_author" content="Althoff, Matthias">
  <meta name="citation_publication_date" content="2025">
  <meta name="citation_conference_title" content="todo">
  <meta name="citation_pdf_url" content="https://arxiv.org/pdf/todo">
  
  <!-- Additional SEO, og #2563eb -->
  <meta name="theme-color" content="#3070B3">
  <meta name="msapplication-TileColor" content="#3070B3">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  
  <!-- Preconnect for performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://ajax.googleapis.com">
  <link rel="preconnect" href="https://documentcloud.adobe.com">
  <link rel="preconnect" href="https://cdn.jsdelivr.net">


  <!-- TODO: Replace with your paper title and authors -->
  <title>From Demonstrations to Safe Deployment: Path-Consistent SafetyFiltering for Diffusion Policies</title>

  <!-- Favicon and App Icons -->
  <link rel="icon" type="image/x-icon" href="static/images/favicon.ico">
  <link rel="apple-touch-icon" href="static/images/favicon.ico">
  
  <!-- Critical CSS - Load synchronously -->
  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/index.css">
  
  <!-- Non-critical CSS - Load asynchronously -->
  <link rel="preload" href="static/css/bulma-carousel.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href="static/css/bulma-slider.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href="static/css/fontawesome.all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  
  <!-- Fallback for browsers that don't support preload -->
  <noscript>
    <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  </noscript>
  
  <!-- Fonts - Optimized loading -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Defer non-critical JavaScript -->
  <script defer src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script defer src="static/js/bulma-carousel.min.js"></script>
  <script defer src="static/js/bulma-slider.min.js"></script>
  <script defer src="static/js/index.js"></script>
  
  <!-- Structured Data for Academic Papers -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "ScholarlyArticle",
    "headline": "From Demonstrations to Safe Deployment: Path-Consistent SafetyFiltering for Diffusion Policies",
    "description": "This paper presents a novel approach to safe deployment of diffusion policies without compromising task success.",
    "author": [
      {
        "@type": "Person",
        "name": "Ralf Römer",
        "affiliation": {
          "@type": "Organization",
          "name": "Learning Systems and Robotics Lab, Technical University of Munich"
        }
      },
      {
        "@type": "Person",
        "name": "Julian Balletshofer",
        "affiliation": {
          "@type": "Organization",
          "name": "Cyber Physical Systems Group, Technical University of Munich"
        }
      },
      {
        "@type": "Person",
        "name": "Jakob Thumm",
        "affiliation": {
          "@type": "Organization",
          "name": "Autonomous Systems Lab, Stanford University"
        }
      },
      {
        "@type": "Person",
        "name": "Marco Pavone",
        "affiliation": {
          "@type": "Organization",
          "name": "Autonomous Systems Lab, Stanford University"
        }
      },
      {
        "@type": "Person",
        "name": "Angela P. Schoellig",
        "affiliation": {
          "@type": "Organization",
          "name": "Learning Systems and Robotics Lab, Technical University of Munich"
        }
      },
      {
        "@type": "Person",
        "name": "Matthias Althoff",
        "affiliation": {
          "@type": "Organization",
          "name": "Cyber Physical Systems Group, Technical University of Munich"
        }
      },

    ],
    "datePublished": "2025-10-10",
    "publisher": {
      "@type": "Organization",
      "name": "Neural Information Processing Systems Foundation",
      "url": "https://neurips.cc"
    },
    "url": "https://tum-lsy.github.io/pacs/",
    "image": "https://tum-lsy.github.io/pacs/static/images/social_preview.png",
    "keywords": ["robotics", "imitation learning", "diffusion policies", "safety", "human-robot-interaction"],
    "abstract": "Diffusion policies (DPs) achieve state-of-the-art performance on complex manipulation tasks by learning from large-scale demonstration datasets, often spanning multiple embodiments and environments. However, they cannot guarantee safe behavior, so external safety mechanisms are needed. These, however, alter actions in ways unseen during training, causing unpredictable behavior and performance degradation. To address these problems, we propose path-consistent safety filtering (PACS) for DPs. Our approach performs path-consistent braking on a trajectory computed from the sequence of generated actions. In this way, we keep execution consistent with the policy's training distribution, maintaining the learned, task-completing behavior. To enable a real-time deployment and handle uncertainties, we verify safety using set-based reachability analysis. Our experimental evaluation in simulation and on three challenging real-world human-robot interaction tasks shows that PACS (a) provides formal safety guarantees in dynamic environments, (b) preserves task success rates, and (c) outperforms reactive safety approaches, such as control barrier functions, by up to 68% in terms of task success.",
    "citation": "@inproceedings{pacs2025,\n  title={From Demonstrations to Safe Deployment: Path-Consistent Safety Filtering for Diffusion Policies},\n  author={Ralf R\"omer and Julian Balletshofer and Jakob Thumm and Marco Pavone and Angela P. Schoellig and Matthias Althoff},\n  booktitle={TODO},\n  year={TODO}\n}",
    "isAccessibleForFree": true,
    "license": "https://creativecommons.org/licenses/by/4.0/",
    "mainEntity": {
      "@type": "WebPage",
      "@id": "https://tum-lsy.github.io/pacs/"
    },
    "about": [
      {
        "@type": "Thing",
        "name": "Robotics"
      },
      {
        "@type": "Thing", 
        "name": "Imitation Learning"
      },
      {
        "@type": "Thing",
        "name": "Safety"
      }
    ]
  }
  </script>
  
  <!-- Website/Organization Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "Learning Systems and Robotics Lab, Technical University of Munich",
    "url": "https://www.dynsyslab.org",
    "logo": "https://tum-lsy.github.io/pacs/static/images/learnsyslab_logo.ico",
    "sameAs": [
      "https://www.linkedin.com/company/learnsyslab",
      "https://github.com/utiasDSL"
    ]
  }
  </script>
</head>
<body>


  <!-- Scroll to Top Button -->
  <button class="scroll-to-top" onclick="scrollToTop()" title="Scroll to top" aria-label="Scroll to top">
    <i class="fas fa-chevron-up"></i>
  </button>


  <main id="main-content">
  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <!-- TODO: Replace with your paper title -->
            <h1 class="title is-1 publication-title">From Demonstrations to Safe Deployment: Path-Consistent Safety Filtering for Diffusion Policies</h1>

            <!-- TODO: Replace with your paper venue and year -->
            <!-- <div class="is-flex is-justify-content-center is-align-items-center" style="margin-bottom: 1em;">
              <img src="static/images/NeurIPS-logo.svg" alt="NeurIPS Logo" style="height:5em; margin-right:0.5em;">
              <span class="is-size-4 has-text-weight-bold" style="vertical-align:middle; color:#68448B;">NeurIPS 2025</span>
            </div> -->

            <div class="is-size-5 publication-authors">
              <!-- TODO: Replace with your paper authors and their personal links -->
              <span class="author-block">
                <a href="https://ralfroemer99.github.io" target="_blank">Ralf Römer</a><sup>*,1</sup>,</span>
              <span class="author-block">
                <a href="https://www.linkedin.com/in/julian-balletshofer-6861641b8/" target="_blank">Julian Balletshofer</a><sup>*,1</sup>,</span>
              <span class="author-block">
                <a href="https://jakob-thumm.com/" target="_blank">Jakob Thumm</a><sup>2</sup>,</span>
              <span class="author-block">
                <a href="https://www.linkedin.com/in/adriankobras/" target="_blank">Marco Pavone</a><sup>2</sup>,</span>
              <span class="author-block">
                <a href="https://www.dynsyslab.org/prof-angela-schoellig/" target="_blank">Angela P. Schoellig</a><sup>1</sup>,</span>
              <span class="author-block">
                <a href="https://www.ce.cit.tum.de/cps/home/" target="_blank">Matthias Althoff</a><sup>1</sup></span>
              </div>

              <div class="is-size-5 publication-authors">
                <span class="author-block"><sup>1</sup> Department of Computer Engineering, Technical University of Munich</span>
                <span class="author-block"><sup>2</sup> Department of Aeronautics and Astronautics, Stanford University</span>
                <span class="eql-cntrb"><small><br><sup>*</sup>Equal Contribution</small></span>
              </div>

              <div class="is-flex is-justify-content-center is-align-items-center" style="gap: 0.5em; margin: 1em 0;">
                <img src="static/images/learnsyslab_logo.png" alt="LSY" style="height:4em;">
                <img src="static/images/Logo_of_the_Technical_University_of_Munich.svg" alt="TUM" style="height:2em;">
              </div>

              <div class="column has-text-centered">
                <div class="publication-links" style="display: flex; flex-wrap: wrap; justify-content: center; gap: 0.5em;">
                  <span class="link-block" style="width:auto;">
                    <a href="https://arxiv.org/pdf/todo" target="_blank"
                    class="external-link button is-normal is-rounded is-dark pub-btn">
                      <span class="icon">
                        <i class="fas fa-file-pdf"></i>
                      </span>
                      <span>Paper</span>
                    </a>
                  </span>
                  <span class="link-block" style="width:auto;">
                    <a href="https://github.com/todo" target="_blank"
                    class="external-link button is-normal is-rounded is-dark pub-btn">
                      <span class="icon">
                        <i class="fab fa-github"></i>
                      </span>
                      <span>Code</span>
                    </a>
                  </span>
                  <span class="link-block" style="width:auto;">
                    <a href="https://arxiv.org/abs/todo" target="_blank"
                    class="external-link button is-normal is-rounded is-dark pub-btn">
                      <span class="icon">
                        <i class="ai ai-arxiv"></i>
                      </span>
                      <span>arXiv</span>
                    </a>
                  </span>
                </div>
              </div>
              <style>
              @media (max-width: 600px) {
                .publication-links {
                  flex-direction: column !important;
                  align-items: center !important;
                }
                .publication-links .link-block {
                  width: 100% !important;
                  display: flex;
                  justify-content: center;
                  margin-bottom: 0.5em;
                }
                .publication-links .pub-btn {
                  width: 100% !important;
                  justify-content: center;
                }
              }
              </style>
              </style>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Paper abstract -->
<section class="section hero is-light" id="examples">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <!-- TODO: Replace with your paper abstract -->
          <p>
            <strong>Diffusion policies (DPs)</strong> achieve state-of-the-art performance on complex manipulation tasks by learning from large-scale demonstration datasets, often spanning multiple embodiments and environments.
            However, they <strong>cannot guarantee safe behavior</strong>, so external safety mechanisms are needed.
            These, however, alter actions in ways unseen during training, causing <strong>unpredictable behavior and performance degradation</strong>.
            To address these problems, we propose <u>pa</u>th-<u>c</u>onsistent <u>s</u>afety filtering (PACS) for DPs.
            Our approach performs <strong>path-consistent braking</strong> on a trajectory computed from the sequence of generated actions.
            In this way, we keep execution consistent with the policy's training distribution, maintaining the learned, task-completing behavior.
            To enable a real-time deployment and handle uncertainties, we verify safety using set-based reachability analysis.
            Our experimental evaluation in simulation and on three challenging real-world human-robot interaction tasks shows that PACS (a) provides <strong>formal safety guarantees</strong> in dynamic environments, (b) preserves task success rates, and (c) <strong>outperforms reactive safety approaches</strong>, such as control barrier functions, by up to 68% in terms of task success.
          </p>
        </div>
      </div>
    </div>
    <div class="column has-text-right robot-pretzel-img" style="display: flex; justify-content: flex-end; align-items: center; margin-top: -9em; margin-right: -1em; margin-bottom: -2em;">
      <img src="static/images/robot_pretzel_above.png" alt="Right Side Image" style="max-width: 120px; height: auto;">
    </div>
    <style>
    @media (max-width: 600px), (max-width: 900px) and (orientation: landscape) {
      .robot-pretzel-img {
      justify-content: center !important;
      margin: 0 !important;
      }
    }
    </style>
  </div>
</section>
<!-- End paper abstract -->

<!-- Why -->
<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Motivation</h2>
        <div class="content has-text-justified">
          <!-- Text -->
          <p>
            Recent advances in imitation learning with generative policies (diffusion, flow matching) have enabled robots to solve increasingly complex tasks. However, safe deployment remains challenging:
            <ul>
              <li>Distribution shifts or compounding errors can cause unpredictable and erratic behavior, leading to task failures.</li>
              <li>Existing methods either:
                <ul>
                  <li>Flag any OOD observation/action (<strong>many false alarms</strong>)</li>
                  <li>Use VLMs to retrospectively detect failures (<strong>too late</strong>)</li>
                  <li>Rely on the existence of failure data (<strong>unsafe/impractical to collect</strong>)</li>
                  <li>Use only policy inputs or outputs alone, missing crucial correlations</li>
                  <li>Fail to account for the multi-modal action distributions of generative policies</li>
                </ul>
              </li>
            </ul>
            We address these challenges with <strong>FIPER</strong>, a framework for failure prediction at runtime that provides early and accurate warnings without requiring failure examples.
          </p>
        </div>
        <div class="columns is-centered is-vcentered" style="align-items: flex-start; margin-top: 4em;">
          <div class="column is-one-quarter has-text-centered">
            <figure style="display: flex; flex-direction: column; align-items: center;">
              <img src="static/images/1modex.png" alt="Low uncertainty" style="height:2.7cm; object-fit:contain;">
              <figcaption style="margin-top:0.5em;">(a) Low uncertainty</figcaption>
            </figure>
          </div>
          <div class="column is-one-quarter has-text-centered">
            <figure style="display: flex; flex-direction: column; align-items: center;">
              <img src="static/images/nomodex.png" alt="High uncertainty" style="height:2.7cm; object-fit:contain;">
              <figcaption style="margin-top:0.5em;">(b) High uncertainty</figcaption>
            </figure>
          </div>
          <div class="column is-one-quarter has-text-centered">
            <figure style="display: flex; flex-direction: column; align-items: center;">
              <img src="static/images/2modesx.png" alt="Low uncertainty" style="height:2.7cm; object-fit:contain;">
              <figcaption style="margin-top:0.5em;">(c) Low uncertainty</figcaption>
            </figure>
          </div>
          <div class="column is-one-quarter has-text-centered">
            <figure style="display: flex; flex-direction: column; align-items: center;">
              <img src="static/images/temporalmodesx.png" alt="Consecutive low uncertainty" style="height:2.7cm; object-fit:contain;">
              <figcaption style="margin-top:0.5em;">(d) Consecutive low uncertainty</figcaption>
            </figure>
          </div>
        </div>
        <div class="column is-12 has-text-centered" style="margin-top: -0.5em;">
          <span class="is-size-6">
            Figure 1: Generative models are able to learn multi-modal action distributions. In contrast to other methods, FIPER is specifically designed to handle these multi-modal action capabilities.
          </span>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End Why -->

<!-- How -->
<section class="section hero is-light">
  <div class="container is-max-desktop has-text-centered">
    <h2 class="title is-3">Method</h2>
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <img src="static/images/fiper.png" alt="Shield illustration" style="width:100%; height:auto; margin-bottom:2em;">
        <div class="content has-text-justified">
          <!-- Text -->
          <p>
            The design of FIPER is motivated by the insight that failures typically involve unfamiliar observations and ambiguous actions. 
            Therefore, FIPER predicts policy failures during runtime by combining two complementary indicators:
            <ul>
              <li><strong>Observation-Based Score (RND-OE):</strong> Random Network Distillation applied in the policy’s own observation embedding space detects when current observations deviate from those seen in successful rollouts. Applying RND to the observation embeddings instead of raw observations improves robustness to irrelevant distribution shifts.</li>
              <li><strong>Action Chunk Entropy (ACE):</strong> The uncertainty in a batch of action chunks is quantified via a novel entropy score in end-effector space, capturing persistent ambiguity in the robot’s intended behavior. Our proposed score is both computationally lightweight and effective at handling multi-modal action distributions.</li>
            </ul>
            Both scores are aggregated over short <strong>moving windows</strong> and calibrated with <strong>conformal prediction</strong> using only a small number of successful trajectories. A failure alarm is raised only when both indicators exceed their respective thresholds, yielding early and robust prediction while avoiding false alarms on benign OOD states.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End How -->


<!-- Task Overview Images -->
<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-four-fifths has-text-centered">
        <h2 class="title is-3">Evaluation</h2>
        <div class="content has-text-justified">
          <!-- Text -->
          <p>
            We evaluate FIPER across five diverse tasks using both diffusion- and flow-based policies. Calibration relies only on a small set of successful rollouts (50 in simulation, 10 in the real world). Across all environments, FIPER consistently predicts failures earlier and more accurately than baselines, highlighting its potential to enhance uncertainty quantification and safety of generative robot policies.
          </p>
        </div>
        <img src="static/images/task_overview_sim.png" alt="Task Overview 1" style="width:100%; height:auto; display:block;">
        <img src="static/images/task_overview_rw.png" alt="Task Overview 2" style="width:100%; height:auto; display:block; margin-top:2em;">
      </div>
    </div>
  </div>
</section>

<!-- Videos -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-four-fifths has-text-centered">
        <h2 class="title is-3">Examples</h2>
        <div class="content has-text-justified">
          <!-- Text -->
          <p>
            The videos below show example rollouts of our real-world rope manipulation task (10x). The left column shows successful rollouts where the robot manages to form a pretzel, while the right column shows failure cases where the robot fails to grasp the rope or the rope does not stay in place. <strong>As soon as FIPER predicts a failure, the frame around the video turns red.</strong>
          </p>
        </div>
        <div style="display: flex; justify-content: center;">
          <span class="link-block hide-on-mobile" style="width:auto; margin-bottom:2em;">
            <a id="play-all-videos"
               href="javascript:void(0);"
               class="button is-normal is-link is-light"
               style="color: #3070B3;">
              <span class="icon">
                <i class="fas fa-play"></i>
              </span>
              <span>Play All Videos</span>
            </a>
          </span>
        </div>
        <div class="columns is-centered landscape-grid" data-landscape-columns="2">
          <div class="column is-half">
            <div class="video-container hover-controls">
              <video class="sync-video" width="100%" height="315" preload="metadata"
                poster="static/videos/thumbnails/rope_success_2120.png" style="background-color: #f0f0f0;"
                muted playsinline webkit-playsinline>
                <source src="static/videos/rope_success_2120.mp4" type="video/mp4">
                Your browser does not support the video tag.
              </video>
              <p class="has-text-centered" style="color:#5993C3; font-weight:bold;">Success Rollout</p>
            </div>
          </div>
          <div class="column is-half">
            <div class="video-container hover-controls">
              <video class="sync-video" width="100%" height="315" preload="metadata"
                poster="static/videos/thumbnails/rope_failure_2122.png" style="background-color: #f0f0f0;"
                muted playsinline webkit-playsinline>
                <source src="static/videos/rope_failure_2122.mp4" type="video/mp4">
                Your browser does not support the video tag.
              </video>
              <p class="has-text-centered" style="color:#E35555; font-weight:bold;">Failure Rollout</p>
              <p class="has-text-centered" style="color:#808080;">(rope does not stay in place)</p>
            </div>
          </div>
        </div>
        <div class="columns is-centered landscape-grid" data-landscape-columns="2">
          <div class="column is-half">
            <div class="video-container hover-controls">
              <video class="sync-video" width="100%" height="315" preload="metadata"
                poster="static/videos/thumbnails/rope_success_2121.png" style="background-color: #f0f0f0;"
                muted playsinline webkit-playsinline>
                <source src="static/videos/rope_success_2121.mp4" type="video/mp4">
                Your browser does not support the video tag.
              </video>
              <p class="has-text-centered" style="color:#5993C3; font-weight:bold;">Success Rollout</p>
            </div>
          </div>
          <div class="column is-half">
            <div class="video-container hover-controls">
              <video class="sync-video" width="100%" height="315" preload="metadata"
                poster="static/videos/thumbnails/rope_failure_2125.png" style="background-color: #f0f0f0;"
                muted playsinline webkit-playsinline>
                <source src="static/videos/rope_failure_2125.mp4" type="video/mp4">
                Your browser does not support the video tag.
              </video>
              <p class="has-text-centered" style="color:#E35555; font-weight:bold;">Failure Rollout</p>
              <p class="has-text-centered" style="color:#808080;">(misplacement and grasp failure)</p>
            </div>
          </div>
        </div>
        <style>
        .video-container {
          position: relative;
          width: 100%;
          padding-bottom: 0%;
          margin-bottom: 0em;
        }
        .video-container iframe {
          position: absolute;
          top: 0; left: 0;
          width: 100%; height: 100%;
        }
        /* Hide controls by default, show on hover/focus */
        .hover-controls video::-webkit-media-controls {
          opacity: 0;
          pointer-events: none;
          transition: opacity 0.2s;
        }
        .hover-controls:hover video::-webkit-media-controls,
        .hover-controls:focus-within video::-webkit-media-controls {
          opacity: 1;
          pointer-events: auto;
        }
        /* For Firefox */
        .hover-controls video::-moz-media-controls {
          opacity: 0;
          pointer-events: none;
          transition: opacity 0.2s;
        }
        .hover-controls:hover video::-moz-media-controls,
        .hover-controls:focus-within video::-moz-media-controls {
          opacity: 1;
          pointer-events: auto;
        }
        @media screen and (max-width: 900px) and (orientation: landscape) {
          .landscape-grid {
            display: flex !important;
            flex-wrap: nowrap !important;
          }
          .landscape-grid[data-landscape-columns="2"] > .column {
            flex: 0 0 50% !important;
            max-width: 50% !important;
            width: 50% !important;
          }
          .landscape-grid[data-landscape-columns="3"] > .column {
            flex: 0 0 33.3333% !important;
            max-width: 33.3333% !important;
            width: 33.3333% !important;
          }
          .landscape-grid[data-landscape-columns="4"] > .column {
            flex: 0 0 25% !important;
            max-width: 25% !important;
            width: 25% !important;
          }
        }
        </style>
        <script>
        document.querySelectorAll('.hover-controls video').forEach(function(video) {
          video.controls = false;
          video.parentElement.addEventListener('mouseenter', function() {
            video.controls = true;
          });
          video.parentElement.addEventListener('mouseleave', function() {
            if (!video.paused && !video.ended) return;
            video.controls = false;
          });
          video.addEventListener('focus', function() {
            video.controls = true;
          });
          video.addEventListener('blur', function() {
            if (!video.paused && !video.ended) return;
            video.controls = false;
          });
        });
        </script>
        <script>
        // Play all videos in sync when button is clicked
        document.getElementById('play-all-videos').onclick = function() {
          var videos = document.querySelectorAll('.sync-video');
          videos.forEach(function(video) {
            video.currentTime = 0;
            video.play();
          });
        };
        </script>
        <div style="margin-top:2em;">
          <a href="javascript:void(0);" id="show-more-videos-btn" class="external-link button is-normal is-rounded is-dark pub-btn" style="text-decoration:none;">
            More Videos
          </a>
        </div>
        <div id="extra-videos" style="display:none;">
          <!-- PushT Videos Row -->
          <section class="section">
            <div class="container is-max-desktop">
              <h2 class="title is-4 has-text-centered">PushT</h2>
              <div class="content has-text-justified">
                <!-- Text -->
                <p>
                  Although they are often correlated,
                  accurate failure prediction requires differentiating between out-of-distribution (OOD) situations to which the policy
                  can generalize and actual failures. In the PushT environment, OOD conditions are created by
                  varying the scale and dimensions of the T-object. Notably, the polilcy can also fail under in-distribution (ID) conditions.
                  Compared to baselines, our scores <strong> RND-OE and ACE better distinguish true failures from OOD situations the policy can generalize to</strong>.
                </p>
              </div>
              <div style="display: flex; justify-content: center; margin-bottom: 1em;">
                <span class="link-block" style="width:auto;">
                  <a id="play-all-pusht-videos"
                     href="javascript:void(0);"
                     class="button is-normal is-link is-light"
                     style="color: #3070B3;">
                    <span class="icon">
                      <i class="fas fa-play"></i>
                    </span>
                    <span>Play All Videos</span>
                  </a>
                </span>
              </div>
              <div class="columns is-centered landscape-grid" data-landscape-columns="4">
                <div class="column is-one-quarter has-text-centered">
                  <div class="video-container hover-controls">
                    <video class="pusht-video" width="100%" height="180" preload="metadata"
                      poster="static/videos/thumbnails/pusht_success_id.png" style="background-color: #f0f0f0;"
                      muted playsinline webkit-playsinline>
                      <source src="static/videos/pusht_success_id.mp4" type="video/mp4">
                      Your browser does not support the video tag.
                    </video>
                    <p class="has-text-centered" style="color:#5993C3; font-weight:bold;">Success Rollout</p>
                    <p class="has-text-centered" style="color:#808080;">(ID conditions)</p>
                  </div>
                </div>
                <div class="column is-one-quarter has-text-centered">
                  <div class="video-container hover-controls">
                    <video class="pusht-video" width="100%" height="180" preload="metadata"
                      poster="static/videos/thumbnails/pusht_success_ood.png" style="background-color: #f0f0f0;"
                      muted playsinline webkit-playsinline>
                      <source src="static/videos/pusht_success_ood.mp4" type="video/mp4">
                      Your browser does not support the video tag.
                    </video>
                    <p class="has-text-centered" style="color:#5993C3; font-weight:bold;">Success Rollout</p>
                    <p class="has-text-centered" style="color:#808080;">(OOD conditions)</p>
                  </div>
                </div>
                <div class="column is-one-quarter has-text-centered">
                  <div class="video-container hover-controls">
                    <video class="pusht-video" width="100%" height="180" preload="metadata"
                      poster="static/videos/thumbnails/pusht_failure_id.png" style="background-color: #f0f0f0;"
                      muted playsinline webkit-playsinline>
                      <source src="static/videos/pusht_failure_id.mp4" type="video/mp4">
                      Your browser does not support the video tag.
                    </video>
                    <p class="has-text-centered" style="color:#E35555; font-weight:bold;">Failure Rollout</p>
                    <p class="has-text-centered" style="color:#808080;">(ID conditions)</p>
                  </div>
                </div>
                <div class="column is-one-quarter has-text-centered">
                  <div class="video-container hover-controls">
                    <video class="pusht-video" width="100%" height="180" preload="metadata"
                      poster="static/videos/thumbnails/pusht_failure_ood.png" style="background-color: #f0f0f0;"
                      muted playsinline webkit-playsinline>
                      <source src="static/videos/pusht_failure_ood.mp4" type="video/mp4">
                      Your browser does not support the video tag.
                    </video>
                    <p class="has-text-centered" style="color:#E35555; font-weight:bold;">Failure Rollout</p>
                    <p class="has-text-centered" style="color:#808080;">(OOD conditions)</p>
                  </div>
                </div>
              </div>
            </div>
            <style>
              /* Hide controls by default, show on hover */
              .hover-controls video::-webkit-media-controls {
                opacity: 0;
                pointer-events: none;
                transition: opacity 0.2s;
              }
              .hover-controls:hover video::-webkit-media-controls,
              .hover-controls:focus-within video::-webkit-media-controls {
                opacity: 1;
                pointer-events: auto;
              }
              /* For Firefox */
              .hover-controls video::-moz-media-controls {
                opacity: 0;
                pointer-events: none;
                transition: opacity 0.2s;
              }
              .hover-controls:hover video::-moz-media-controls,
              .hover-controls:focus-within video::-moz-media-controls {
                opacity: 1;
                pointer-events: auto;
              }
            </style>
            <script>
              // Play all pusht videos
              document.getElementById('play-all-pusht-videos').onclick = function() {
                var videos = document.querySelectorAll('.pusht-video');
                videos.forEach(function(video) {
                  video.currentTime = 0;
                  video.play();
                });
              };

              // JS fallback for hiding controls if pseudo-elements are not supported
              document.querySelectorAll('.hover-controls video').forEach(function(video) {
                video.controls = false;
                video.parentElement.addEventListener('mouseenter', function() {
                  video.controls = true;
                });
                video.parentElement.addEventListener('mouseleave', function() {
                  if (!video.paused && !video.ended) return; // keep controls if playing
                  video.controls = false;
                });
                // Also show controls on keyboard focus for accessibility
                video.addEventListener('focus', function() {
                  video.controls = true;
                });
                video.addEventListener('blur', function() {
                  if (!video.paused && !video.ended) return;
                  video.controls = false;
                });
              });
            </script>
          </section>

          <!-- Sorting Videos Row (all in one row) -->
          <section class="section">
            <div class="container is-max-desktop">
              <h3 class="title is-4 has-text-centered">Sorting</h3>
              <div class="content has-text-justified">
                <!-- Text -->
                <p>
                  For the sorting task, OOD conditions are created by varying the size of the cubes.
                  As soon as FIPER predicts a failure, the frame around the video turns red.
                </p>
              </div>
              <div style="display: flex; justify-content: center; margin-bottom: 1em;">
                <span class="link-block" style="width:auto;">
                  <a id="play-all-sorting-videos"
                     href="javascript:void(0);"
                     class="button is-normal is-link is-light"
                     style="color: #3070B3;">
                    <span class="icon">
                      <i class="fas fa-play"></i>
                    </span>
                    <span>Play All Videos</span>
                  </a>
                </span>
              </div>
              <div class="columns is-centered landscape-grid" data-landscape-columns="4">
                <div class="column is-one-quarter has-text-centered">
                  <div class="video-container hover-controls">
                    <video class="sorting-video" width="100%" height="240" preload="metadata"
                      poster="static/videos/thumbnails/sorting_success_id.png" style="background-color: #f0f0f0;"
                      muted playsinline webkit-playsinline>
                      <source src="static/videos/sorting_success_id.mp4" type="video/mp4">
                      Your browser does not support the video tag.
                    </video>
                    <p class="has-text-centered" style="color:#5993C3; font-weight:bold;">Success Rollout</p>
                    <p class="has-text-centered" style="color:#808080;">(ID conditions)</p>
                  </div>
                </div>
                <div class="column is-one-quarter has-text-centered">
                  <div class="video-container hover-controls">
                    <video class="sorting-video" width="100%" height="240" preload="metadata"
                      poster="static/videos/thumbnails/sorting_success_ood.png" style="background-color: #f0f0f0;"
                      muted playsinline webkit-playsinline>
                      <source src="static/videos/sorting_success_ood.mp4" type="video/mp4">
                      Your browser does not support the video tag.
                    </video>
                    <p class="has-text-centered" style="color:#5993C3; font-weight:bold;">Success Rollout</p>
                    <p class="has-text-centered" style="color:#808080;">(OOD conditions)</p>
                  </div>
                </div>
                <div class="column is-one-quarter has-text-centered">
                  <div class="video-container hover-controls">
                    <video class="sorting-video" width="100%" height="240" preload="metadata"
                      poster="static/videos/thumbnails/sorting_failure_id.png" style="background-color: #f0f0f0;"
                      muted playsinline webkit-playsinline>
                      <source src="static/videos/sorting_failure_id.mp4" type="video/mp4">
                      Your browser does not support the video tag.
                    </video>
                    <p class="has-text-centered" style="color:#E35555; font-weight:bold;">Failure Rollout</p>
                    <p class="has-text-centered" style="color:#808080;">(ID conditions)</p>
                  </div>
                </div>
                <div class="column is-one-quarter has-text-centered">
                  <div class="video-container hover-controls">
                    <video class="sorting-video" width="100%" height="240" preload="metadata"
                      poster="static/videos/thumbnails/sorting_failure_ood.png" style="background-color: #f0f0f0;"
                      muted playsinline webkit-playsinline>
                      <source src="static/videos/sorting_failure_ood.mp4" type="video/mp4">
                      Your browser does not support the video tag.
                    </video>
                    <p class="has-text-centered" style="color:#E35555; font-weight:bold;">Failure Rollout</p>
                    <p class="has-text-centered" style="color:#808080;">(OOD conditions)</p>
                  </div>
                </div>
              </div>
              </div>
              </div>
              <style>
                /* Hide controls by default, show on hover */
                .hover-controls video::-webkit-media-controls {
                  opacity: 0;
                  pointer-events: none;
                  transition: opacity 0.2s;
                }
                .hover-controls:hover video::-webkit-media-controls {
                  opacity: 1;
                  pointer-events: auto;
                }
                /* For Firefox */
                .hover-controls video::-moz-media-controls {
                  opacity: 0;
                  pointer-events: none;
                  transition: opacity 0.2s;
                }
                .hover-controls:hover video::-moz-media-controls {
                  opacity: 1;
                  pointer-events: auto;
                }
                /* Fallback for browsers that don't support pseudo-elements: hide controls via JS */
              </style>
              <script>
                // Play all sorting videos
                document.getElementById('play-all-sorting-videos').onclick = function() {
                  var videos = document.querySelectorAll('.sorting-video');
                  videos.forEach(function(video) {
                    video.currentTime = 0;
                    video.play();
                  });
                };

                // JS fallback for hiding controls if pseudo-elements are not supported
                document.querySelectorAll('.hover-controls video').forEach(function(video) {
                  video.controls = false;
                  video.parentElement.addEventListener('mouseenter', function() {
                    video.controls = true;
                  });
                  video.parentElement.addEventListener('mouseleave', function() {
                    if (!video.paused && !video.ended) return; // keep controls if playing
                    video.controls = false;
                  });
                });
              </script>
              </section>
              </div>
              <script>
                document.getElementById('show-more-videos-btn').onclick = function() {
                  var extra = document.getElementById('extra-videos');
                  extra.style.display = 'block';
                  this.style.display = 'none';
                  // Optionally scroll to the new content
                  extra.scrollIntoView({behavior: 'smooth'});
                };
              </script>
      </div>
    </div>
  </div>
</section>
<!-- End Videos -->

<!-- Highlights -->
<section class="section">
  <div class="container is-max-desktop has-text-centered">
    <h2 class="title is-3">Highlights</h2>
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <div class="content has-text-justified">
          <ul>
            <li>FIPER predicts failures of generative robot policies at runtime <strong>without requiring failure data</strong>,</li>
            <li>combines observation-based and action-based indicators for <strong>fast and robust</strong> failure prediction,</li>
            <li>does <strong>not require access to the policy's training data</strong> and is calibrated using only a small number of successful rollouts,</li>
            <li>uses <strong>conformal prediction</strong> to provide statistical guarantees on prediction performance,</li>
            <li>outperforms existing methods in <strong>distinguishing true failures from out-of-distribution situations</strong> the policy can generalize to.</li>
          </ul>
        </div>
      </div>
    </div>
    <img id="reveal-img" src="static/images/pretzel.svg" alt="Click to reveal"
      style="height:100px; width:auto; cursor:pointer; transition: filter 0.2s, box-shadow 0.2s;">
    <div id="reveal-text" style="visibility:hidden; opacity:0; height:2em; margin-top:-1em; transition: opacity 0.2s;">
      <span class="content has-text-justified">
      For more, check out our <a href="https://arxiv.org/abs/2510.09459" target="_blank">paper</a>.
      </span>
    </div>
    <style>
      #reveal-img:hover {
        filter: drop-shadow(0 0 16px #3070B3) brightness(1.2) saturate(1.5);
      }
      #reveal-text {
        display: block;
        overflow: hidden;
      }
      @keyframes wiggle {
        0% { transform: rotate(0deg);}
        10% { transform: rotate(-10deg);}
        20% { transform: rotate(12deg);}
        30% { transform: rotate(-8deg);}
        40% { transform: rotate(6deg);}
        50% { transform: rotate(-4deg);}
        60% { transform: rotate(2deg);}
        70% { transform: rotate(-1deg);}
        80% { transform: rotate(0deg);}
        100% { transform: rotate(0deg);}
      }
      .wiggle {
        animation: wiggle 0.7s ease-in-out;
      }
    </style>
    <script>
      var wiggleInterval;
      document.getElementById('reveal-img').onclick = function() {
        var txt = document.getElementById('reveal-text');
        txt.style.visibility = 'visible';
        txt.style.opacity = '1';
        if (wiggleInterval) {
          clearInterval(wiggleInterval);
        }
      };
      // Wiggle animation every 5 seconds until text is revealed
      wiggleInterval = setInterval(function() {
        var img = document.getElementById('reveal-img');
        img.classList.add('wiggle');
        setTimeout(function() {
          img.classList.remove('wiggle');
        }, 700);
      }, 5000);
    </script>
  </div>
</section>
<!-- End Highlights -->

<!--BibTex citation -->
<section class="section" id="BibTeX">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-four-fifths content">
        <div class="bibtex-header">
          <h2 class="title">BibTeX</h2>
          <button class="copy-bibtex-btn" onclick="copyBibTeX()" title="Copy BibTeX to clipboard">
            <i class="fas fa-copy"></i>
            <span class="copy-text">Copy</span>
          </button>
        </div>
        <pre id="bibtex-code"><code>@inproceedings{pacs2025,
          title={From Demonstrations to Safe Deployment: Path-Consistent Safety Filtering for Diffusion Policies},
          author={Ralf R{\"o}mer and Julian Balletshofer and Jakob T.Ralf R\"omer and Julian Balletshofer and Jakob Thumm and Marco Pavone and Angela P. Schoellig and Matthias Althoff},
          booktitle={TODO},
          year={2025}
        }</code></pre>
      </div>
    </div>
  </div>
</section>
<!--End BibTex citation -->


<footer class="footer">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-four-fifths content">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            It is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
        <!-- Visitor Counter -->
        <div id="visitor-count"
             style="text-align:center; margin-top:-1.25em; margin-bottom:-2.25em; font-size:0.9em; color:#999; opacity:0; transition:opacity 0.3s;">
          Visitors: <span id="count">–</span>
        </div>
        <script>
(async () => {
  const container = document.getElementById("visitor-count");
  const span = document.getElementById("count");
  const url = "https://hitscounter.dev/api/hit?output=json&url=https%3A%2F%2Ftum-lsy.github.io%2Fpacs%2F&label=Visitors&icon=arrow-right-circle-fill&color=%236ea8fe&message=&style=for-the-badge&tz=Europe%2FBerlin";
  try {
    const res = await fetch(url, { cache: "no-store", headers: { "Accept": "application/json" } });
    const data = await res.json();
    let val = null;
    if (data) {
      if (typeof data.total_hits === "number") val = data.total_hits;
      else if (typeof data.today_hits === "number") val = data.today_hits;
      else if (typeof data.count === "number") val = data.count;
    }
    if (typeof val === "number" && !Number.isNaN(val)) {
      span.textContent = val.toLocaleString();
      container.style.opacity = "1";
    } else {
      span.textContent = "n/a";
      container.style.opacity = "1";
    }
  } catch (e) {
    span.textContent = "error";
    container.style.opacity = "1";
    console.error("Visitor counter error:", e);
  }
})();
        </script>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
